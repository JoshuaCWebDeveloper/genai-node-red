# GenaiNodeRed

<a alt="Nx logo" href="https://nx.dev" target="_blank" rel="noreferrer"><img src="https://raw.githubusercontent.com/nrwl/nx/master/images/nx-logo.png" width="45"></a>

✨ **This workspace has been generated by [Nx, Smart Monorepos · Fast CI.](https://nx.dev)** ✨

## Custom Frontend Client for Node-RED - Planning Session

### Project Scope

The custom frontend client for Node-RED will focus on providing an intuitive and efficient user experience for building and managing flows. The core functionalities will include:

-   **Flow Builder**: This is the most critical part of the application. It will allow users to add nodes to a canvas through drag and drop, finish connections between nodes, and access node options via a context menu. The flow builder will enable users to visually create and edit flows, making the process as intuitive as possible.

-   **Display of Available Nodes**: A sidebar on the left-hand side of the interface will display the available nodes. This sidebar will categorize nodes by their types or functionalities, allowing users to easily find and select the nodes they need for their flows.

-   **Creation of New Flows and Subflows**: Users will be able to create new flows and subflows within the application. This functionality will support organizing complex projects by allowing users to segment their work into manageable, modular flows and subflows.

-   **Saving Flows**: The client will integrate with the Node-RED API to save the current state of flows to a `flows.json` file, mirroring the functionality of the existing Node-RED frontend. This feature ensures that users can persist their work and retrieve it later, maintaining continuity in their project development.

### Additional MVP Considerations

-   **Node Configuration and Editing**: Provide a user-friendly interface for configuring and editing node properties to tailor the behavior of each node within the flows.

-   **Flow Debugging and Testing Tools**: Incorporate basic debugging tools to assist users in testing and troubleshooting their flows, enhancing the development experience.

-   **Import/Export Flows**: Enable users to import and export their flows in JSON format, facilitating easy sharing, backup, and migration of work.

-   **Responsive Design**: Ensure the frontend client is accessible and usable across various devices by adopting a responsive design approach.

### Development Environment Setup

-   Ensure Node.js and npm are installed.
-   Set up Nx workspace specifically for the Node-RED frontend client.
-   Install necessary libraries and frameworks (e.g., Angular, React, or Vue.js).

### UI/UX Design

-   Sketch initial design mockups for the main interface.
-   Plan the user flow and interaction with the Node-RED backend.
-   Use tools like Figma or Sketch for high-fidelity prototypes.

### Integration with Node-RED Backend

-   Explore Node-RED's API documentation for integration points.
-   Design a service layer in the frontend to communicate with Node-RED's backend.
-   Implement authentication and authorization if required.

### Development

-   Start coding based on the designs and integration plans.
-   Follow best coding practices and ensure code quality with linting and code reviews.
-   Use Nx commands to run and build the project efficiently.

### Testing

-   Plan unit and integration tests for the frontend components and services.
-   Use Nx to execute tests across the monorepo.
-   Consider end-to-end testing for critical user flows.

### Deployment

-   Configure the build process for production deployment.
-   Choose a hosting platform (e.g., Netlify, Vercel, AWS).
-   Set up continuous integration and deployment (CI/CD) pipelines.

### Running tasks with Nx

-   Use `npx nx serve flow-client` for development.
-   Build with `npx nx build flow-client` for production.

### Additional Resources

-   [Nx Console for enhanced development experience](https://nx.dev/nx-console)
-   [Explore the project graph with `npx nx graph`](https://nx.dev/core-features/explore-graph)
-   [Set up CI with Nx](https://nx.dev/recipes/ci)

## Connect with us!

-   [Join the community](https://nx.dev/community)
-   [Subscribe to the Nx Youtube Channel](https://www.youtube.com/@nxdevtools)
-   [Follow us on Twitter](https://twitter.com/nxdevtools)

## Project Management

This section outlines the epics and their associated tasks for the development of the custom frontend client for Node-RED. We use checklists to track progress on each epic and its tasks.

### Epics and Tasks

-   [ ] **Flow Builder**

    -   [x] (Priority 1) Design the flow canvas for placing and connecting nodes.
    -   [ ] (Priority 2) Implement the node palette with search and filter capabilities.
    -   [ ] (Priority 3) Implement drag-and-drop interface for nodes.
    -   [ ] (Priority 4) Develop node connection functionality.
    -   [ ] (Priority 5) Implement editor UI for nodes (individual node attributes, properties, dialog box, etc...).
    -   [ ] (Priority 7) Create context menu for node options.
    -   [ ] (Priority 8) Add undo/redo functionality for flow editing.
    -   [ ] (Priority 9) Implement an auto-save feature to periodically save work.
    -   [ ] (Priority 10) Implement connection validation to ensure valid flows and report any errors to the user before saving.
    -   [ ] (Priority 11) Ensure the flow builder interface is responsive across devices.
    -   [ ] (Priority 12) Optimize performance for a smooth user experience.
    -   [ ] (Priority 13) Provide help and tutorial guides for new users.

-   [ ] **Node Management Interface**

    -   [ ] Design sidebar for displaying nodes.
    -   [ ] Categorize nodes by type/functionality.
    -   [ ] Implement UI for node configuration and editing.

-   [ ] **Flow and Subflow Management**

    -   [ ] Develop UI for creating new flows/subflows.
    -   [ ] Implement flow/subflow organization mechanisms.

-   [ ] **Integration with Node-RED Backend**

    -   [ ] Establish API communication for flow management.
    -   [ ] Implement import/export functionality for flows.
    -   [ ] Ensure authentication and authorization mechanisms.

-   [ ] **UI/UX Design and Responsive Layout**

    -   [ ] Sketch initial design mockups.
    -   [ ] Develop high-fidelity prototypes.
    -   [ ] Implement responsive design.

-   [ ] **Debugging and Testing Tools**

    -   [ ] Incorporate basic debugging tools.
    -   [ ] Plan and implement a logging system.

-   [ ] **Development Environment and Tooling Setup**

    -   [ ] Set up Nx workspace and necessary libraries.
    -   [ ] Configure code quality tools and practices.

-   [ ] **Testing and Quality Assurance**

    -   [ ] Write unit and integration tests.
    -   [ ] Execute end-to-end tests for critical flows.

-   [ ] **Deployment and CI/CD**

    -   [ ] Configure build process for deployment.
    -   [ ] Set up CI/CD pipelines.

-   [ ] **Documentation and Community Engagement**
    -   [ ] Create project documentation.
    -   [ ] Engage with the community for feedback.

### Progress Tracking

As tasks are completed, check them off to visually track progress towards the completion of each epic. This interactive checklist will help keep the project organized and provide a clear view of what has been accomplished and what remains to be done.

## Flow Builder Development - Technical Details

The Flow Builder is the cornerstone of our custom frontend client for Node-RED, enabling users to visually create and edit flows with ease. To achieve a robust, intuitive, and efficient development of this epic, we have selected the following key libraries:

### @projectstorm/react-diagrams

-   **Purpose**: Serves as the core library for rendering the flow diagrams. It provides the functionality to create custom nodes, ports, and links, making it ideal for building complex, interactive diagrams with drag-and-drop capabilities.
-   **Documentation**: [https://projectstorm.gitbook.io/react-diagrams/](https://projectstorm.gitbook.io/react-diagrams/)

### react-dnd

-   **Purpose**: Facilitates the drag-and-drop functionality within the flow builder, allowing users to drag nodes from the sidebar into the canvas and arrange them to form flows. Its flexible API supports complex drag-and-drop scenarios, which are essential for a seamless user experience in flow construction.
-   **Documentation**: [https://react-dnd.github.io/react-dnd/about](https://react-dnd.github.io/react-dnd/about)

### react-hook-form

-   **Purpose**: Used for managing forms within the application, particularly for node configuration dialogs. React Hook Form provides an efficient, flexible, and extensible way to handle form state and validation, improving the performance and user experience of form interactions.
-   **Documentation**: [https://react-hook-form.com/](https://react-hook-form.com/)

### Integration Strategy

-   **@projectstorm/react-diagrams** will be utilized to construct the visual flow editor interface, enabling the creation, connection, and configuration of nodes within a flow.
-   **react-dnd** will be integrated with @projectstorm/react-diagrams to enhance the user interface with drag-and-drop capabilities, allowing for an intuitive method of adding and organizing nodes within the flow canvas.
-   **react-hook-form** will be employed in modal dialogs for node configuration, ensuring that form data is efficiently managed and validated, providing a user-friendly configuration experience.

By leveraging these libraries, we aim to build a Flow Builder that is not only powerful and flexible but also intuitive and user-friendly. This will enable users to efficiently create and manage their Node-RED flows directly within our custom frontend client.

## Flow Builder - Detailed Task Descriptions

### Priority 1: Design the Flow Canvas for Placing and Connecting Nodes

**Objective**: Create a user-friendly and intuitive canvas area where users can add, arrange, and connect nodes to form flows.

**Technical Requirements**:

-   Implement a scalable and navigable canvas that supports zooming and panning.
-   Design considerations must include how nodes will be displayed, selected, and how connections between nodes will be visualized.
-   The canvas should be implemented in a way that supports high performance, even with a large number of nodes and connections.
-   Integration points with `@projectstorm/react-diagrams` need to be identified and utilized for rendering the canvas and its elements.

To accomplish this task, the following components from `@projectstorm/react-diagrams` and React will be utilized:

1. **DiagramEngine**: Manages the rendering and operation of the diagram, handling the setup and rendering of the canvas, nodes, and links.
2. **DiagramModel**: Represents the model of the diagram, including nodes, links, and their connections. This is used by the `DiagramEngine` to render the diagram.
3. **CanvasWidget**: Renders the flow canvas, taking a `DiagramEngine` as a prop and displaying the diagram based on the current model.
4. **DefaultNodeModel** and **DefaultPortModel**: Used for creating nodes with ports that can be connected with links. These models support the basic functionality needed for the initial task.
5. **DefaultLinkModel**: Represents the connections between ports on different nodes, supporting straight and curved links that can be styled.

### Priority 2: Implement the Node Palette with Search and Filter Capabilities

**Objective**: Develop a sidebar or palette that displays available nodes, allowing users to search and filter nodes to find what they need quickly.

**Technical Requirements**:

-   The node palette should categorize nodes based on their type or functionality to help users find the appropriate nodes for their flows.
-   Implement search functionality that allows users to type in keywords to filter and quickly locate specific nodes.
-   Each node in the palette should have a visual representation (icon and label) that makes it easy to identify.
-   Ensure that the node palette is responsive and accessible, with considerations for keyboard navigation and screen readers.
-   The implementation should be modular, allowing for easy updates or additions of new node types in the future.

### Priority 3: Implement Drag-and-Drop Interface for Nodes

**Objective**: Enable users to drag nodes from the node palette and drop them onto the canvas to add them to their flow.

**Technical Requirements**:

-   Utilize `react-dnd` for implementing the drag-and-drop functionality, ensuring a smooth and intuitive user experience.
-   Ensure that nodes can be dragged from the palette and visually follow the cursor until dropped onto the canvas.
-   On dropping a node onto the canvas, the node should be added to the flow at the drop location, with its position being adjustable by dragging.
-   Implement visual feedback during the drag operation, such as highlighting potential drop areas or showing a "ghost" of the node being dragged.
-   Considerations must be made for how the canvas and nodes respond to different screen sizes and resolutions.

### Priority 4: Develop Node Connection Functionality

**Objective**: Allow users to create connections between nodes on the canvas, forming logical flows.

**Technical Requirements**:

-   Implement a method for users to draw connections between nodes, possibly by dragging from one node's output port to another node's input port.
-   Utilize `@projectstorm/react-diagrams` for managing the rendering and logic of connections, ensuring compatibility with the library's way of handling links.
-   Connections should be visually distinct and should support different styles (straight lines, curves) to enhance readability.
-   Include validation to ensure that connections between incompatible node types or ports are not allowed.
-   Provide visual feedback during the connection process, such as highlighting compatible ports when drawing a connection.
